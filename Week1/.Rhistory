geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, family = "arial", face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, family = "TT Arial", face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, family = "Comic Sans MS", face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11,  face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
ggplot(oadata, aes(x = "", y = Approval, fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approval, label = Approval), color = "white")+
scale_fill_manual() +
theme_void()
# PIE CHART
ggplot(oadata, aes(x = "", y = Approval, fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approval, label = Isssue), color = "white")+
scale_fill_manual() +
theme_void()
# PIE CHART
ggplot(oadata, aes(x = "", y = Approval, fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
#geom_text(aes(y = Approval, label = Isssue), color = "white")+
scale_fill_manual() +
theme_void()
# PIE CHART
ggplot(oadata, aes(x = "", y = Approval, fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
#geom_text(aes(y = Approval, label = Isssue), color = "white")+
#scale_fill_manual() +
theme_void()
oadata
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approve , label = Isssue), color = "white")+
scale_fill_manual() +
theme_void()
# PIE CHART
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approve , label = Issue), color = "white")+
scale_fill_manual() +
theme_void()
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approve , label = Issue), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()
# PIE CHART
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "yellow", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approve , label = Issue), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "yellow", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = Approve , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()
# PIE CHART
count.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
count.data
# PIE CHART
oadata <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oadata
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "yellow", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()
# PIE CHART
oadata <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oadata
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()
# PIE CHART
oadata <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oadata
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()+
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
# PIE CHART
oadata <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oadata
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
theme_void()
# PIE CHART
oadata <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oadata
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oadata, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
ggtitle("Obama Ratings by Issue")+
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
theme_void()
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
oadata <- read_excel("./datasets/obama-approval-ratings.xls")
print(oadata)
print(is.data.frame(oadata))
print(ncol(oadata))
print(nrow(oadata))
# PIE CHART
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
ggtitle("Obama Ratings by Issue")+
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
theme_void()
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")
# PIE CHART
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve*.1), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
# PIE CHART
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
# PIE CHART
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data <- subset(oa.data, Issue=='Economy')
oa.data
install.packages("rpivotTable")
library(rpivotTable)
library(rpivotTable)
rpivotTable(oa.data)
oa.datar <- rpivotTable(oa.data)
oa.datar
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data <- subset(oa.data, Issue=='Economy')
oa.data
# PIE CHART
oa.data <- oadata %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data <- subset(oa.data, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data
oa.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(Approve) - 0.5*Approve)
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data
oa.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(value) - 0.5*value)
oa.data
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(value) - 0.5*value)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = Approve , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = Approve*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oa.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(value) - 0.5*value)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "blue", "green", "red", "pink", "black", "brown", "gray", "purple", "orange")
ggplot(oa.data, aes(x = "", y = value , fill = Issue)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
oa.data
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oa.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Approval Ratings by Issue")
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oa.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = "Issue", y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oa.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oaout.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(value) - 0.5*value)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")+
xlim(0.5, 2.5)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
xlim = c(0.5, 2.5) +
ggtitle("Obama Approval Ratings on Economics")
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
xlim = c(0.5, 2.5)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()+
xlim(0.5, 2.5)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()+
xlim(0.5, 2.5)+
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
xlim = c(0.5, 2.5) +
ggtitle("Obama Approval Ratings on Economics")
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()+
xlim(0.5, 2.5)+
#theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
# BAR CHART
# make the base plot and save it in the object "plot_base"
plot_base <- ggplot(data = oadata, mapping = aes(x = reorder(Issue, Approve), y = Approve))
# display the plot object
#plot_base
# save a better-formatted version of the base plot in "plot_base_clean"
plot_base_clean <- plot_base +
# apply basic black and white theme - this theme removes the background colour by default
theme_bw() +
# remove gridlines. panel.grid.major is for vertical lines, panel.grid.minor is for horizontal lines
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
# remove borders
panel.border = element_blank(),
# removing borders also removes x and y axes. Add them back
axis.line = element_line())
# display the plot object
p <- plot_base_clean + theme(axis.text.x = element_text(angle = 90))
p + geom_bar(stat = "identity", fill = "blue") +
ggtitle("Obama Approval Rating by Issue") +
theme(plot.title = element_text(hjust = 0.5))  +
coord_flip()
ggsave("./plots/barchart_obama_approval_ratings_R.png")
# STACKED BAR CHART
DF1 <- melt(oadata, id.var="Issue")
ggplot(DF1, aes(x =Issue, y = value, fill = variable)) +
geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90)) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
ggtitle("Obama Ratings by Issue")+
geom_col() +
geom_text(aes( label = value, group =variable), color = "white", position = position_stack(vjust = 0.5, reverse = FALSE)) +
labs(x = "Issue", y = "Rating")
ggsave("./plots/Stacked_barchart_obama_approval_ratings_R.png")
# PIE CHART
oa.data <- subset(oadata, Issue=='Economy')
oa.data <- melt(oa.data, id.vars = "Issue")
oaout.data <- oa.data %>%
arrange(desc(Issue)) %>%
mutate(lab.ypos = cumsum(value) - 0.5*value)
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = "", y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
ggsave("./plots/Pie_chart_obama_approval_ratings_On_Economics_R.png")
# DONUT CHART
mycols <- c("#0073C2FF", "#EFC000FF", "#868686FF")
ggplot(oaout.data, aes(x = 2, y = value , fill = variable )) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+
geom_text(aes(y = lab.ypos , label = value*.01), color = "white")+
scale_fill_manual(values = mycols) +
theme_void()+
xlim(0.5, 2.5)+
#theme(plot.title = element_text(hjust = 0.5, size = 11, face = "plain")) +
labs(x = NULL, y = "Rating")+
ggtitle("Obama Approval Ratings on Economics")
ggsave("./plots/Donut_chart_obama_approval_ratings_On_Economics_R.png")
